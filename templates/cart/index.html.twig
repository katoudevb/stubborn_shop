{% extends 'base.html.twig' %}

{% block title %}Mon panier
{% endblock %}

{% block body %}
	<div class="container mt-4">
		<h1 class="mb-4">Mon panier</h1>

		{% if cartItems is not empty %}
			<div class="table-responsive">
				<table class="table table-bordered align-middle">
					<thead class="table-light">
						<tr>
							<th>Produit</th>
							<th>Quantité</th>
							<th>Prix unitaire</th>
							<th>Total</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for item in cartItems %}
							<tr>
								<td>{{ item.product.name }}</td>
								<td>{{ item.quantity }}</td>
								<td>{{ item.product.price|number_format(2, ',', ' ') }}
									€</td>
								<td>{{ (item.product.price * item.quantity)|number_format(2, ',', ' ') }}
									€</td>
								<td>
									<form method="post" action="{{ path('app_cart_remove', {'id': item.id}) }}" class="d-inline">
										<input type="hidden" name="_token" value="{{ csrf_token('remove_cart_item_' ~ item.id) }}">
										<button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Êtes-vous sûr de vouloir supprimer cet article ?');">
											Supprimer
										</button>
									</form>
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>

			<p class="fw-bold fs-5">Total :
				{{ total|number_format(2, ',', ' ') }}
				€</p>

			<form method="post" action="{{ path('app_cart_checkout') }}">
				<input type="hidden" name="_token" value="{{ csrf_token('checkout_cart') }}">
				<button type="submit" class="btn btn-success" onclick="return confirm('Êtes-vous sûr de vouloir finaliser votre commande ?');">
					Finaliser ma commande
				</button>
			</form>
		{% else %}
			<div class="alert alert-info">Votre panier est vide.</div>
		{% endif %}

		<p class="mt-3">
			<a href="{{ path('app_products') }}" class="btn btn-link">Continuer mes achats</a>
		</p>
	</div>
{% endblock %}
